<style>

#graphoramaAccordion{

    font-size: 12px;
}


</style>

<script>

    var graphorama = (function () {
        var self = {};
        self.currentRecording = [];
        self.graphoramaLocalKeys = [];

        var localStorageKeys = "souslesensGraphoramaKeys"
        var localStoragePrefix = "souslesensGraphorama"




        self.init = function () {
            graphoramaAccordion = $("#graphoramaAccordion").accordion(
                {
                    active: 1,
                    collapsible: false,
                    activate: function (event, ui) {

                    }
                });
            graphorama.loadAllRecordings();
            $( "#graphoramaAccordion" ).accordion( "option", "active", 0 );

        }


        self.startRecording = function () {
            if (self.currentRecording.length > 0) {
                return self.stopRecording();
            } else
                self.currentRecording = [];
            $( "#graphoramaAccordion" ).accordion( "option", "active", 1);
        }



        self.stopRecording = function () {
            debugger
            var name = prompt("save recording with name ")
            if (!name || name == "") {
                if (confirm("delete current recording"))
                    return self.currentRecording = [];
                return;
            }
            else {
                var date = new Date();
                var obj = {
                    name: name,
                    data: self.currentRecording,
                    date: date
                }
                var key = localStoragePrefix + "_" + name;
                self.graphoramaLocalKeys.push(key)
                localStorage.setItem(localStorageKeys, JSON.stringify(self.graphoramaLocalKeys));
                localStorage.setItem(key, JSON.stringify(obj));


            }
        }

        self.addGraph = function () {
            var title = prompt("enter graph title")
            if (!title || title == "")
                return;
            var date = new Date();
            self.currentRecording.push({
                title: title,
                data: visjsGraph.graphHistory[visjsGraph.graphHistory.currentIndex],
                date: date
            })

        }
        self.addSlides=function(){

        }


        self.loadAllRecordings = function () {
            var keys = localStorage.getItem(localStorageKeys);
            keys = JSON.parse(keys);
            common.fillSelectOptionsWithStringArray(graphorama_recordSelect, keys, true)

        }

        self.loadRecording = function () {
            var name = $("#graphorama_recordSelect").val();
            var recording = localStorage.getItem(name);
            recording = JSON.parse(recording).data;
            self.currentRecording = recording;
            common.fillSelectOptions(graphorama_slidesSelect, recording, "title", "title", true)


        }
        self.playSlide = function () {
            debugger
            var index = $("#graphorama_slidesSelect").prop('selectedIndex')
            visjsGraph.importGraph(self.currentRecording[index].data)

        }


        self.deleteRecording = function () {

        }

        self.saveRecording = function () {

        }


        self.nextPage = function () {
            visjsGraph.showNextGraph()
        }
        self.previousPage = function () {
            visjsGraph.showPreviousGraph()
        }


        return self;

    })()


</script>
<div id="graphoramaAccordion">

    <h3>Graphoramas</h3>
    <div id="graphorama_savedGraphoramasDiv" style="min-height: 200px">

      <table>
          <tr>
              <td>
                  <select id="graphorama_recordSelect" ondblclick="graphorama.loadRecording()" size="10" style="width:250px"></select>
              </td>

              <td>

                  <button onclick="graphorama.startRecording()"> new</button><br>
                  <button onclick="graphorama.addSlides()"> add </button><br>
                  <button onclick="graphorama.loadRecording()"> load</button><br>
                  <button onclick="graphorama.deleteRecording()"> delete</button><br>
                  <button onclick="graphorama.saveRecording()"> save</button>
              </td>
          </tr>
      </table>

    </div>

    <h3>Actions</h3>
    <div id="graphorama_currentGraphoramasDiv" style="min-height: 200px">
    <table>
        <tr>
            <td>

                <button onclick="graphorama.stopRecording()">stopRecording</button>
                <button onclick="graphorama.addGraph()">select Graph</button>
            </td>

            <td>
                <button onclick="graphorama.nextPage()">next</button>
                <button onclick="graphorama.previousPage()">previous</button>
            </td>
        </tr>
    </table>




        <br>

    </div>


</div>
<div>
   Slides
    <select id="graphorama_slidesSelect" size="10" style="width:250px" onclick="graphorama.playSlide()"></select>
</div>



